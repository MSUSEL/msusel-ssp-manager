{"platform":{"name":"ubuntu","release":"24.04","target_id":"d2111083-60e2-528a-8a75-14e2e2460ed3"},"profiles":[{"name":"tests from inspec..authentication_test.rb","sha256":"eb70d4262706ecb2171d5690b87b1119e89fe8cc032dca8e728800f3dcfab570","title":"tests from inspec//authentication_test.rb","supports":[],"attributes":[],"groups":[{"id":"authentication_test.rb","controls":["authentication-policy"]}],"controls":[{"id":"authentication-policy","title":"Validate Authentication Controls","desc":"Ensure that identification and authentication controls are properly enforced (IA-2)","descriptions":[{"label":"default","data":"Ensure that identification and authentication controls are properly enforced (IA-2)"}],"impact":1.0,"refs":[],"tags":{},"code":"control 'authentication-policy' do\n  impact 1.0\n  title 'Validate Authentication Controls'\n  desc 'Ensure that identification and authentication controls are properly enforced (IA-2)'\n\n  app_url = 'http://localhost:8000'\n  log_file_path = './logs/opa_interactions.log'\n\n  # Test case 1: Regular user with valid credentials\n  describe 'Regular user authentication' do\n    login_response = http(\"#{app_url}/login\",\n                          method: 'POST',\n                          headers: { 'Content-Type' => 'application/json' },\n                          data: { \n                            username: 'regular_user', \n                            password: 'SecurePassword123',\n                            type: 'regular',\n                            factors: 1\n                          }.to_json)\n\n    it 'should authenticate regular user with password' do\n      expect(login_response.status).to eq(200)\n      expect(JSON.parse(login_response.body)['authenticated']).to eq(true)\n      expect(JSON.parse(login_response.body)).to include('access_token')\n    end\n  end\n\n  # Test case 2: Staff user without MFA\n  describe 'Staff user authentication without MFA' do\n    login_response = http(\"#{app_url}/login\",\n                          method: 'POST',\n                          headers: { 'Content-Type' => 'application/json' },\n                          data: { \n                            username: 'staff_user', \n                            password: 'StaffSecurePass789',\n                            type: 'staff',\n                            factors: 1\n                          }.to_json)\n\n    it 'should reject staff authentication without MFA' do\n      expect(login_response.status).to eq(401)\n      expect(JSON.parse(login_response.body)['authenticated']).to eq(false)\n      expect(JSON.parse(login_response.body)['reason']).to include('MFA required')\n    end\n  end\n\n  # Test case 3: Staff user with MFA\n  describe 'Staff user authentication with MFA' do\n    login_response = http(\"#{app_url}/login\",\n                          method: 'POST',\n                          headers: { 'Content-Type' => 'application/json' },\n                          data: { \n                            username: 'staff_user', \n                            password: 'StaffSecurePass789',\n                            mfa_code: '123456',\n                            type: 'staff',\n                            factors: 2\n                          }.to_json)\n\n    it 'should authenticate staff user with MFA' do\n      expect(login_response.status).to eq(200)\n      expect(JSON.parse(login_response.body)['authenticated']).to eq(true)\n      expect(JSON.parse(login_response.body)).to include('access_token')\n    end\n  end\n\n  # Test case 4: Admin user with MFA\n  describe 'Admin user authentication with MFA' do\n    login_response = http(\"#{app_url}/login\",\n                          method: 'POST',\n                          headers: { 'Content-Type' => 'application/json' },\n                          data: { \n                            username: 'admin_user', \n                            password: 'AdminSecurePass456',\n                            mfa_code: '654321',\n                            type: 'admin',\n                            factors: 2\n                          }.to_json)\n\n    it 'should authenticate admin user with MFA' do\n      expect(login_response.status).to eq(200)\n      expect(JSON.parse(login_response.body)['authenticated']).to eq(true)\n      expect(JSON.parse(login_response.body)).to include('access_token')\n    end\n  end\n\n  # Test case 5: Brute force detection\n  describe 'Brute force detection' do\n    # Simulate multiple failed login attempts\n    5.times do\n      http(\"#{app_url}/login\",\n           method: 'POST',\n           headers: { 'Content-Type' => 'application/json' },\n           data: { \n             username: 'target_user', \n             password: 'WrongPassword',\n             type: 'regular',\n             factors: 1\n           }.to_json)\n    end\n\n    # Try one more login attempt\n    final_attempt = http(\"#{app_url}/login\",\n                         method: 'POST',\n                         headers: { 'Content-Type' => 'application/json' },\n                         data: { \n                           username: 'target_user', \n                           password: 'WrongPasswordAgain',\n                           type: 'regular',\n                           factors: 1\n                         }.to_json)\n\n    it 'should detect brute force attempts' do\n      expect(final_attempt.status).to eq(429)\n      expect(JSON.parse(final_attempt.body)['authenticated']).to eq(false)\n      expect(JSON.parse(final_attempt.body)['reason']).to include('too many failed attempts')\n    end\n  end\n\n  # Test case 6: Expired token\n  describe 'Expired token validation' do\n    # Use a token that is known to be expired\n    expired_token = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJleHBpcmVkX3VzZXIiLCJleHAiOjE1MTYyMzkwMjIsImlhdCI6MTUxNjIzOTAyMn0.expired_signature'\n    \n    validate_response = http(\"#{app_url}/validate_token\",\n                             method: 'POST',\n                             headers: { 'Content-Type' => 'application/json' },\n                             data: { token: expired_token }.to_json)\n\n    it 'should reject expired tokens' do\n      expect(validate_response.status).to eq(401)\n      expect(JSON.parse(validate_response.body)['valid']).to eq(false)\n      expect(JSON.parse(validate_response.body)['reason']).to include('expired')\n    end\n  end\n\n  # Validate OPA logs for authentication decisions\n  describe file(log_file_path) do\n    its('content') { should include 'authentication' }\n    its('content') { should include 'authentication_valid' }\n    its('content') { should include 'token_is_valid' }\n    its('content') { should include 'mfa_used' }\n  end\nend\n","source_location":{"line":1,"ref":"inspec//authentication_test.rb"},"waiver_data":{},"results":[{"status":"passed","code_desc":"Regular user authentication should authenticate regular user with password","run_time":0.012040549,"start_time":"2025-04-24T11:15:24-06:00","resource_class":"Object","resource_params":"[]","resource_id":"Regular user authentication"},{"status":"passed","code_desc":"Staff user authentication without MFA should reject staff authentication without MFA","run_time":0.004551733,"start_time":"2025-04-24T11:15:24-06:00","resource_class":"Object","resource_params":"[]","resource_id":"Staff user authentication without MFA"},{"status":"passed","code_desc":"Staff user authentication with MFA should authenticate staff user with MFA","run_time":0.003658741,"start_time":"2025-04-24T11:15:24-06:00","resource_class":"Object","resource_params":"[]","resource_id":"Staff user authentication with MFA"},{"status":"passed","code_desc":"Admin user authentication with MFA should authenticate admin user with MFA","run_time":0.003779741,"start_time":"2025-04-24T11:15:24-06:00","resource_class":"Object","resource_params":"[]","resource_id":"Admin user authentication with MFA"},{"status":"failed","code_desc":"Brute force detection should detect brute force attempts","run_time":0.01698847,"start_time":"2025-04-24T11:15:24-06:00","message":"\nexpected: 429\n     got: 401\n\n(compared using ==)\n","resource_class":"Object","resource_params":"[]","resource_id":"Brute force detection"},{"status":"failed","code_desc":"Expired token validation should reject expired tokens","run_time":0.004174351,"start_time":"2025-04-24T11:15:24-06:00","message":"\nexpected: 401\n     got: 404\n\n(compared using ==)\n","resource_class":"Object","resource_params":"[]","resource_id":"Expired token validation"},{"status":"passed","code_desc":"File ./logs/opa_interactions.log content is expected to include \"authentication\"","run_time":0.000292008,"start_time":"2025-04-24T11:15:24-06:00","resource_class":"file","resource_params":"[\"./logs/opa_interactions.log\"]","resource_id":"./logs/opa_interactions.log"},{"status":"passed","code_desc":"File ./logs/opa_interactions.log content is expected to include \"authentication_valid\"","run_time":9.9836e-05,"start_time":"2025-04-24T11:15:24-06:00","resource_class":"file","resource_params":"[\"./logs/opa_interactions.log\"]","resource_id":"./logs/opa_interactions.log"},{"status":"failed","code_desc":"File ./logs/opa_interactions.log content is expected to include \"token_is_valid\"","run_time":0.001256445,"start_time":"2025-04-24T11:15:24-06:00","message":"expected \"{\\\"timestamp\\\":\\\"2025-04-22T23:45:57.015Z\\\",\\\"package\\\":\\\"security.authentication\\\",\\\"decision\\\":\\\"a...\\\":{\\\"payload\\\":{\\\"sub\\\":\\\"admin_user\\\",\\\"exp\\\":1745518524}},\\\"now\\\":1745514924},\\\"result\\\":true}\\n\" to include \"token_is_valid\"\nDiff:\n@@ -1,41 +1,81 @@\n-token_is_valid\n+{\"timestamp\":\"2025-04-22T23:45:57.015Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.052Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.066Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.078Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.099Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.117Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.130Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.145Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.172Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.172Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.184Z\",\"package\":\"security.access_control\",\"decision\":\"deny_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.184Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":false}\n+{\"timestamp\":\"2025-04-22T23:45:57.192Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"admin_user\",\"roles\":[\"user\",\"admin\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.192Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.201Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.201Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.024Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.041Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.051Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.058Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.070Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.076Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.082Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.088Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.103Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.103Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.109Z\",\"package\":\"security.access_control\",\"decision\":\"deny_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.108Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":false}\n+{\"timestamp\":\"2025-04-22T23:52:56.112Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"admin_user\",\"roles\":[\"user\",\"admin\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.112Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.117Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.117Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.528Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.550Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.556Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.562Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.572Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.577Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.582Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.588Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.600Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.599Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.605Z\",\"package\":\"security.access_control\",\"decision\":\"deny_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.605Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":false}\n+{\"timestamp\":\"2025-04-24T17:15:14.610Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"admin_user\",\"roles\":[\"user\",\"admin\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.610Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.614Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.614Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:19.377Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518519}},\"now\":1745514919},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:19.396Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518519}},\"now\":1745514919},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:24.685Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\",\"factors\":1},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518524}},\"now\":1745514924},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:24.701Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"staff_user\",\"type\":\"staff\"},\"authentication\":{\"method\":\"mfa\",\"factors\":2},\"token\":{\"payload\":{\"sub\":\"staff_user\",\"exp\":1745518524}},\"now\":1745514924},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:24.705Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"mfa\",\"factors\":2},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518524}},\"now\":1745514924},\"result\":true}\n","resource_class":"file","resource_params":"[\"./logs/opa_interactions.log\"]","resource_id":"./logs/opa_interactions.log"},{"status":"failed","code_desc":"File ./logs/opa_interactions.log content is expected to include \"mfa_used\"","run_time":0.001224384,"start_time":"2025-04-24T11:15:24-06:00","message":"expected \"{\\\"timestamp\\\":\\\"2025-04-22T23:45:57.015Z\\\",\\\"package\\\":\\\"security.authentication\\\",\\\"decision\\\":\\\"a...\\\":{\\\"payload\\\":{\\\"sub\\\":\\\"admin_user\\\",\\\"exp\\\":1745518524}},\\\"now\\\":1745514924},\\\"result\\\":true}\\n\" to include \"mfa_used\"\nDiff:\n@@ -1,41 +1,81 @@\n-mfa_used\n+{\"timestamp\":\"2025-04-22T23:45:57.015Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.052Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.066Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.078Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.099Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.117Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.130Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.145Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369157}},\"now\":1745365557},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.172Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.172Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.184Z\",\"package\":\"security.access_control\",\"decision\":\"deny_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.184Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":false}\n+{\"timestamp\":\"2025-04-22T23:45:57.192Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"admin_user\",\"roles\":[\"user\",\"admin\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.192Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:45:57.201Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:45:57.201Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.024Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.041Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.051Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.058Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.070Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.076Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.082Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.088Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745369576}},\"now\":1745365976},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.103Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.103Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.109Z\",\"package\":\"security.access_control\",\"decision\":\"deny_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.108Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":false}\n+{\"timestamp\":\"2025-04-22T23:52:56.112Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"admin_user\",\"roles\":[\"user\",\"admin\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.112Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-22T23:52:56.117Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-22T23:52:56.117Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.528Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.550Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.556Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.562Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.572Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.577Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.582Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.588Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518514}},\"now\":1745514914},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.600Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.599Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.605Z\",\"package\":\"security.access_control\",\"decision\":\"deny_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.605Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":false}\n+{\"timestamp\":\"2025-04-24T17:15:14.610Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"admin_user\",\"roles\":[\"user\",\"admin\"],\"status\":\"active\"},\"resource\":\"admin_panel\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.610Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:14.614Z\",\"package\":\"security.access_control\",\"decision\":\"allow_access\",\"input\":{\"user\":{\"id\":\"regular_user\",\"roles\":[\"user\"],\"status\":\"active\"},\"resource\":\"user_profile\",\"action\":\"access_resource\",\"request\":{\"time\":\"2025-04-24T17:15:14.614Z\",\"ip\":\"::ffff:127.0.0.1\"}},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:19.377Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518519}},\"now\":1745514919},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:19.396Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"password\"},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518519}},\"now\":1745514919},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:24.685Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"regular_user\",\"type\":\"regular\"},\"authentication\":{\"method\":\"password\",\"factors\":1},\"token\":{\"payload\":{\"sub\":\"regular_user\",\"exp\":1745518524}},\"now\":1745514924},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:24.701Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"staff_user\",\"type\":\"staff\"},\"authentication\":{\"method\":\"mfa\",\"factors\":2},\"token\":{\"payload\":{\"sub\":\"staff_user\",\"exp\":1745518524}},\"now\":1745514924},\"result\":true}\n+{\"timestamp\":\"2025-04-24T17:15:24.705Z\",\"package\":\"security.authentication\",\"decision\":\"authentication_valid\",\"input\":{\"user\":{\"id\":\"admin_user\",\"type\":\"admin\"},\"authentication\":{\"method\":\"mfa\",\"factors\":2},\"token\":{\"payload\":{\"sub\":\"admin_user\",\"exp\":1745518524}},\"now\":1745514924},\"result\":true}\n","resource_class":"file","resource_params":"[\"./logs/opa_interactions.log\"]","resource_id":"./logs/opa_interactions.log"}]}],"status":"loaded","status_message":""}],"statistics":{"duration":0.053384751},"version":"6.8.11"}